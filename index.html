<!DOCTYPE html>
<html lang="bn" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>মাসউদ আলিমী - সীরাত কোর্স</title>
    
    <!-- Tailwind CSS (No build step required) -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    
    <!-- Tailwind Config for Dark Mode & Colors -->
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['ui-sans-serif', 'system-ui', 'sans-serif', "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji"],
                        serif: ['ui-serif', 'Georgia', 'Cambria', "Times New Roman", 'Times', 'serif'],
                    },
                    colors: {
                        emerald: {
                            50: '#ecfdf5', 100: '#d1fae5', 200: '#a7f3d0', 300: '#6ee7b7', 
                            400: '#34d399', 500: '#10b981', 600: '#059669', 700: '#047857', 
                            800: '#065f46', 900: '#064e3b', 950: '#022c22',
                        }
                    }
                }
            }
        }
    </script>

    <style>
        /* Custom Animations */
        .hide-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .hide-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
        @keyframes fade-in {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-fade-in {
            animation: fade-in 0.4s ease-out forwards;
        }
        @keyframes marquee {
            0% { transform: translateX(0); }
            100% { transform: translateX(-50%); }
        }
        .animate-marquee {
            display: flex;
            white-space: nowrap;
            animation: marquee 15s linear infinite;
        }
        .animate-marquee:hover {
            animation-play-state: paused;
        }
    </style>
</head>
<body class="bg-stone-50 text-stone-800 transition-colors duration-300 min-h-screen flex flex-col">

    <!-- App Root -->
    <div id="app" class="contents">
        <!-- Content will be injected here by JavaScript -->
    </div>

    <!-- Application Logic -->
    <script>
        /**
         * ==================================================================================
         * CONFIGURATION & DATA
         * ==================================================================================
         */
        const GLOBAL_NOTICE = `দারসের আলোচনা আর "সীরাত পাঠ" বইয়ের ১৫ থেকে ৪৫ পৃষ্ঠার মধ্যে পরবর্তী পরীক্ষা হবে ইনশা আল্লাহু তা'আলা।`;

        const COURSE_DATA = [
            {
                id: 1,
                date: "2023-10-15",
                duration: "45 min",
                category: "tafsir",
                driveLink: "https://drive.google.com/file/d/YOUR_FILE_ID_HERE/view?usp=sharing",
                content: {
                    title: "সূরা আল-ফাতিহা - ভূমিকা ও আয়াত ১-৩",
                    description: "সূরা আল-ফাতিহার গুরুত্ব, নাযিল হওয়ার প্রেক্ষাপট এবং প্রথম তিনটি আয়াতের বিস্তারিত তাফসির।",
                    summary: "এই ক্লাসে আমরা কুরআনের জননী খ্যাত সূরা আল-ফাতিহা নিয়ে আলোচনা করেছি। আল্লাহর প্রশংসা এবং রবুবিয়াতের ধারণা ব্যাখ্যা করা হয়েছে।",
                    resources: [
                        { label: "ক্লাস নোট (পিডিএফ)", url: "#" },
                        { label: "রেফারেন্স বই", url: "#" }
                    ]
                }
            },
            {
                id: 2,
                date: "2026-01-02",
                duration: "2 hr 15 min",
                category: "seerat",
                driveLink: "https://drive.google.com/file/d/10ec8WS0aDemwlLFaavuA1_fTyV1m6x3j/view?usp=sharing",
                content: {
                    title: "সীরাত-০১ঃ সীরাত পাঠের গুরুত্ব",
                    description: "আমাদের দৈনন্দিন জীবন ও আখিরাতে সীরাত পাঠের গুরুত্ব ও পদ্ধতি সম্পর্কে আলোচনা করা হয়েছে।",
                    summary: [
                        "তৎকালীন আরবের গোত্রপ্রথা ও সামাজিক ব্যবস্থা",
                        "মূর্তিপূজা এবং নৈতিক অবক্ষয়ের ভয়াবহ চিত্র",
                        "মানবতার মুক্তির জন্য একজন নবীর প্রয়োজনীয়তা",
                        "সীরাত পাঠের গুরুত্ব ও আমাদের করণীয়"
                    ],
                    syllabus: `দারসের আলোচনা আর "সীরাত পাঠ" বইয়ের ১৫ থেকে ৪৫ পৃষ্ঠার মধ্যে পরবর্তী পরীক্ষা হবে ইনশা আল্লাহু তা'আলা।`,
                    resources: [
                        { 
                            label: "বইঃ সীরাত পাঠ - গুরুত্ব, পদ্ধতি ও প্রায়োগিক রুপ<br />(লেখকঃ মাওলানা খালিদ সাইফুল্লাহ রহমানী)", 
                            url: "#" 
                        }
                    ]
                }
            },
            {
                id: 3,
                date: "2023-10-29",
                duration: "40 min",
                category: "tafsir",
                driveLink: "#",
                content: {
                    title: "সূরা আল-ফাতিহা - আয়াত ৪-৭",
                    description: "মালিকি ইয়াওমিদ্দিন এবং সিরাতুল মুস্তাকিমের ব্যাখ্যা।",
                    summary: "বিচার দিবসের মালিকানা এবং সরল সঠিক পথের প্রার্থনা। কাদের পথে চলতে হবে এবং কাদের পথ পরিহার করতে হবে তার বিশদ আলোচনা।",
                    resources: []
                }
            }
        ];

        const TEXTS = {
            siteTitle: "মাসউদ আলিমী",
            subtitle: "কুরআন তাফসির ও সীরাত কোর্স",
            home: "হোম",
            searchPlaceholder: "ক্লাস খুঁজুন...",
            listen: "শুনুন",
            download: "ডাউনলোড",
            summary: "সারসংক্ষেপ",
            resources: "রিসোর্স ও নোট",
            syllabus: "পরবর্তী ক্লাসের প্রস্তুতি ও সিলেবাস",
            back: "ফিরে যান",
            playOnDrive: "ড্রাইভে প্লে করুন",
            footerText: "সর্বস্বত্ব সংরক্ষিত © ২০২৬ | মাসউদ আলিমী",
            tafsir: "তাফসির",
            seerat: "সীরাত",
            all: "সব",
            noResults: "কোনো ক্লাস খুঁজে পাওয়া যায়নি।"
        };

        /**
         * ==================================================================================
         * STATE MANAGEMENT
         * ==================================================================================
         */
        const state = {
            darkMode: false,
            view: 'home', // 'home' | 'detail'
            selectedLecture: null,
            filter: 'seerat',
            search: '',
            playerMode: 'embed', // 'embed' | 'direct'
            playbackRate: 1.0
        };

        /**
         * ==================================================================================
         * UTILITIES
         * ==================================================================================
         */
        const getDriveEmbedLink = (url) => {
            const match = (typeof url === 'string' ? url : "").match(/\/d\/(.+)\//);
            if (match && match[1]) {
                return `https://drive.google.com/file/d/${match[1]}/preview`;
            }
            return url;
        };

        const getDriveDirectLink = (url) => {
            const match = (typeof url === 'string' ? url : "").match(/\/d\/(.+)\//);
            if (match && match[1]) {
                return `https://drive.google.com/uc?export=download&id=${match[1]}`;
            }
            return url;
        };

        // Icon component (returns SVG string for custom icons or data attribute for Lucide)
        const MosqueIcon = () => `
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M12 2v4"/>
                <path d="M10 6h4"/>
                <path d="M12 6c3.5 0 6 3 6 7h-12c0-4 2.5-7 6-7Z"/>
                <path d="M18 13v8"/>
                <path d="M6 13v8"/>
                <path d="M6 21h12"/>
                <path d="M10 21v-4a2 2 0 0 1 4 0v4"/>
            </svg>
        `;

        /**
         * ==================================================================================
         * RENDER FUNCTIONS
         * ==================================================================================
         */
        const app = document.getElementById('app');
        const body = document.body;

        function render() {
            // Apply Dark Mode Class
            if (state.darkMode) {
                document.documentElement.classList.add('dark');
                body.classList.remove('bg-stone-50', 'text-stone-800');
                body.classList.add('bg-slate-900', 'text-slate-100');
            } else {
                document.documentElement.classList.remove('dark');
                body.classList.remove('bg-slate-900', 'text-slate-100');
                body.classList.add('bg-stone-50', 'text-stone-800');
            }

            let html = '';
            html += renderHeader();

            if (state.view === 'home') {
                html += renderNoticeBar();
                html += renderHome();
            } else if (state.view === 'detail') {
                html += renderDetail();
            }

            html += renderFooter();
            app.innerHTML = html;
            
            // Re-initialize icons
            lucide.createIcons();
            
            // Re-attach event listeners (since innerHTML wipes them)
            attachListeners();
            
            // Restore search focus if on home
            if(state.view === 'home') {
                const searchInput = document.getElementById('searchInput');
                if(searchInput) {
                    searchInput.value = state.search;
                    if(document.activeElement?.id === 'searchInput') searchInput.focus();
                }
            }
            
            // Restore audio rate if player exists
            const audioEl = document.getElementById('audioPlayer');
            if(audioEl) audioEl.playbackRate = state.playbackRate;
        }

        function renderHeader() {
            const bgClass = state.darkMode ? 'bg-slate-900/90 border-slate-700' : 'bg-white/90 border-stone-200';
            const iconBg = state.darkMode ? 'bg-emerald-600' : 'bg-emerald-500';
            const textClass = state.darkMode ? 'text-emerald-400' : 'text-emerald-700';

            return `
            <header class="sticky top-0 z-50 shadow-md backdrop-blur-md border-b ${bgClass}">
                <div class="container mx-auto px-4 py-3 flex items-center justify-between">
                    <div class="flex items-center gap-3 cursor-pointer" onclick="actions.goHome()">
                        <div class="p-2 rounded-lg ${iconBg} text-white">
                            ${MosqueIcon()}
                        </div>
                        <div>
                            <h1 class="text-lg md:text-xl font-bold leading-tight ${textClass}">${TEXTS.siteTitle}</h1>
                            <p class="text-xs opacity-70 hidden sm:block">${TEXTS.subtitle}</p>
                        </div>
                    </div>
                    <div class="flex items-center gap-3">
                        <button onclick="actions.toggleTheme()" class="p-2 rounded-full hover:bg-black/5 dark:hover:bg-white/10 transition">
                            <i data-lucide="${state.darkMode ? 'sun' : 'moon'}" class="${state.darkMode ? 'text-amber-400' : 'text-slate-600'} w-5 h-5"></i>
                        </button>
                    </div>
                </div>
            </header>
            `;
        }

        function renderNoticeBar() {
            const colors = state.darkMode ? 'bg-emerald-900 text-emerald-100 border-emerald-800' : 'bg-emerald-600 text-white border-emerald-700';
            return `
            <div class="w-full overflow-hidden py-3 shadow-md relative z-10 border-b ${colors}">
                <div class="animate-marquee flex items-center gap-4 w-full">
                    <!-- Duplicated content for seamless scroll -->
                    <div class="flex items-center gap-4 shrink-0">
                        <span class="font-extrabold flex items-center gap-2 px-4"><i data-lucide="bell-ring" class="w-4 h-4" fill="currentColor"></i> নোটিশ:</span>
                        <span class="text-base font-bold tracking-wide">${GLOBAL_NOTICE}</span>
                        <span class="mx-10 opacity-50">|</span>
                    </div>
                     <div class="flex items-center gap-4 shrink-0">
                        <span class="font-extrabold flex items-center gap-2 px-4"><i data-lucide="bell-ring" class="w-4 h-4" fill="currentColor"></i> নোটিশ:</span>
                        <span class="text-base font-bold tracking-wide">${GLOBAL_NOTICE}</span>
                        <span class="mx-10 opacity-50">|</span>
                    </div>
                     <div class="flex items-center gap-4 shrink-0">
                        <span class="font-extrabold flex items-center gap-2 px-4"><i data-lucide="bell-ring" class="w-4 h-4" fill="currentColor"></i> নোটিশ:</span>
                        <span class="text-base font-bold tracking-wide">${GLOBAL_NOTICE}</span>
                        <span class="mx-10 opacity-50">|</span>
                    </div>
                </div>
            </div>
            `;
        }

        function renderHome() {
            const heroBg = state.darkMode ? 'bg-gradient-to-br from-slate-800 to-slate-900 border-slate-700' : 'bg-gradient-to-br from-white to-emerald-50 border-emerald-100 shadow-sm';
            const heroText = state.darkMode ? 'text-emerald-100' : 'text-emerald-900';
            const barBg = state.darkMode ? 'bg-emerald-500' : 'bg-emerald-600';
            
            // Filter logic
            const filtered = COURSE_DATA.filter(l => {
                const matchesSearch = l.content.title.toLowerCase().includes(state.search.toLowerCase()) || 
                                      l.content.description.toLowerCase().includes(state.search.toLowerCase());
                const matchesCategory = state.filter === 'all' || l.category === state.filter;
                return matchesSearch && matchesCategory;
            });

            return `
            <main class="container mx-auto px-4 py-6 md:py-10 min-h-[calc(100vh-140px)] animate-fade-in">
                
                <!-- Hero -->
                <div class="rounded-2xl p-6 md:p-10 text-center space-y-4 border mb-8 ${heroBg}">
                    <div class="flex justify-center mb-2">
                        <div class="h-1 w-20 rounded-full ${barBg}"></div>
                    </div>
                    <h2 class="text-2xl md:text-4xl font-serif font-bold ${heroText}">${TEXTS.subtitle}</h2>
                    <p class="max-w-2xl mx-auto opacity-80 leading-relaxed">
                        কুরআনের গভীর জ্ঞান এবং রাসূল (সা.) এর জীবনের শিক্ষণীয় ঘটনাবলী জানতে আমাদের এই আয়োজন। নিচে সকল ক্লাসের তালিকা দেয়া হলো।
                    </p>
                </div>

                <!-- Controls -->
                <div class="flex flex-col md:flex-row gap-4 justify-between items-center sticky top-20 z-30 py-2 mb-8">
                    <div class="flex gap-2 overflow-x-auto w-full md:w-auto pb-2 md:pb-0 hide-scrollbar">
                        ${['all', 'tafsir', 'seerat'].map(cat => {
                            const isActive = state.filter === cat;
                            const activeClass = state.darkMode ? 'bg-emerald-600 text-white' : 'bg-emerald-600 text-white shadow-md';
                            const inactiveClass = state.darkMode ? 'bg-slate-800 hover:bg-slate-700' : 'bg-white hover:bg-stone-100 border border-stone-200';
                            return `<button onclick="actions.setFilter('${cat}')" class="px-4 py-2 rounded-full text-sm font-medium whitespace-nowrap transition-all ${isActive ? activeClass : inactiveClass}">${cat === 'all' ? TEXTS.all : TEXTS[cat]}</button>`
                        }).join('')}
                    </div>
                    <div class="relative w-full md:w-64">
                        <input id="searchInput" type="text" placeholder="${TEXTS.searchPlaceholder}" 
                            class="w-full pl-10 pr-4 py-2 rounded-full border focus:outline-none focus:ring-2 focus:ring-emerald-500 transition-all ${state.darkMode ? 'bg-slate-800 border-slate-700 placeholder-slate-500 text-white' : 'bg-white border-stone-200 placeholder-stone-400'}"
                            oninput="actions.setSearch(this.value)"
                        >
                        <i data-lucide="search" class="absolute left-3 top-2.5 opacity-50 w-4 h-4"></i>
                    </div>
                </div>

                <!-- Grid -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    ${filtered.length > 0 ? filtered.map(lecture => renderLectureCard(lecture)).join('') : renderEmptyState()}
                </div>
            </main>
            `;
        }

        function renderLectureCard(lecture) {
            const cardBg = state.darkMode ? 'bg-slate-800 border-slate-700 hover:border-emerald-500/50' : 'bg-white border-stone-200 hover:border-emerald-300';
            const catColor = lecture.category === 'tafsir' ? 'bg-emerald-500' : 'bg-amber-500';
            const badgeBg = state.darkMode ? 'bg-slate-700 text-slate-300' : 'bg-stone-100 text-stone-600';
            const titleColor = state.darkMode ? 'text-slate-100' : 'text-slate-800';

            return `
            <div onclick="actions.selectLecture(${lecture.id})" class="group cursor-pointer rounded-xl overflow-hidden border transition-all hover:shadow-lg hover:-translate-y-1 ${cardBg}">
                <div class="h-3 w-full ${catColor}"></div>
                <div class="p-5 space-y-3">
                    <div class="flex justify-between items-start">
                        <span class="text-xs font-bold px-2 py-1 rounded uppercase tracking-wider ${badgeBg}">${TEXTS[lecture.category]}</span>
                        <div class="flex items-center gap-1 text-xs opacity-60">
                            <i data-lucide="calendar" class="w-3 h-3"></i> <span>${lecture.date}</span>
                        </div>
                    </div>
                    <h3 class="text-lg font-bold leading-snug group-hover:text-emerald-500 transition-colors ${titleColor}">${lecture.content.title}</h3>
                    <p class="text-sm opacity-70 line-clamp-2">${lecture.content.description}</p>
                    <div class="pt-3 flex items-center justify-between border-t border-dashed border-gray-500/30 opacity-70 mt-2">
                         <div class="flex items-center gap-1 text-xs">
                           <i data-lucide="clock" class="w-3 h-3"></i> <span>${lecture.duration}</span>
                         </div>
                         <div class="flex items-center gap-1 text-xs font-semibold text-emerald-500">
                           ${TEXTS.listen} <i data-lucide="arrow-left" class="w-3 h-3 rotate-180"></i>
                         </div>
                    </div>
                </div>
            </div>
            `;
        }

        function renderEmptyState() {
            return `
            <div class="col-span-full text-center py-20 opacity-50">
                <div class="inline-block p-4 rounded-full bg-gray-100 dark:bg-slate-800 mb-2">
                    <i data-lucide="search" class="w-6 h-6"></i>
                </div>
                <p>${TEXTS.noResults}</p>
            </div>
            `;
        }

        function renderDetail() {
            const l = state.selectedLecture;
            const cardBg = state.darkMode ? 'bg-slate-800 border-slate-700' : 'bg-white border-stone-200';
            const titleColor = state.darkMode ? 'text-emerald-100' : 'text-emerald-900';
            const badgeClass = l.category === 'tafsir' 
                ? 'bg-emerald-100 text-emerald-800 dark:bg-emerald-900 dark:text-emerald-200' 
                : 'bg-amber-100 text-amber-800 dark:bg-amber-900 dark:text-amber-200';
            
            const playerBg = state.darkMode ? 'bg-slate-900' : 'bg-stone-50';
            const toggleActive = 'bg-white text-emerald-600 shadow-sm dark:bg-slate-700 dark:text-emerald-400';
            const toggleInactive = 'text-slate-500 dark:text-slate-400 hover:text-slate-700';

            // Summary List Logic
            let summaryHTML = '';
            if (Array.isArray(l.content.summary)) {
                summaryHTML = `<ul class="space-y-3 mt-4">` + l.content.summary.map(p => `
                    <li class="flex items-start gap-3 group">
                        <div class="mt-1 p-1 rounded-full ${state.darkMode ? 'bg-emerald-900 text-emerald-400' : 'bg-emerald-100 text-emerald-700'}"><i data-lucide="check-circle-2" class="w-3 h-3"></i></div>
                        <span class="opacity-90 leading-relaxed">${p}</span>
                    </li>
                `).join('') + `</ul>`;
            } else {
                summaryHTML = `<p class="leading-relaxed opacity-90">${l.content.summary}</p>`;
            }

            // Resources Logic
            const resourcesHTML = l.content.resources.length > 0 
                ? `<ul class="space-y-2">` + l.content.resources.map(res => `
                    <li><a href="${res.url}" class="flex items-center gap-2 text-sm p-3 rounded-lg transition-colors ${state.darkMode ? 'bg-slate-700/50 hover:bg-slate-700 text-emerald-400' : 'bg-emerald-50 hover:bg-emerald-100 text-emerald-800'}">
                        <i data-lucide="external-link" class="w-3 h-3"></i> ${res.label}
                    </a></li>
                  `).join('') + `</ul>`
                : `<p class="text-sm opacity-50 italic">কোনো নোট যুক্ত করা হয়নি</p>`;

            return `
            <main class="container mx-auto px-4 py-6 md:py-10 min-h-[calc(100vh-140px)] animate-fade-in">
                <div class="max-w-4xl mx-auto space-y-6">
                    <button onclick="actions.goHome()" class="flex items-center gap-2 text-sm font-medium hover:text-emerald-500 transition-colors ${state.darkMode ? 'text-slate-400' : 'text-slate-600'}">
                        <i data-lucide="arrow-left" class="w-4 h-4"></i> ${TEXTS.back}
                    </button>

                    <div class="rounded-2xl p-6 md:p-8 border shadow-sm ${cardBg}">
                        
                        <!-- Header -->
                        <div class="mb-6 space-y-2">
                            <div class="flex flex-wrap gap-2 items-center mb-2">
                                <span class="text-xs font-bold px-3 py-1 rounded-full uppercase tracking-wider ${badgeClass}">${TEXTS[l.category]}</span>
                                <span class="text-xs opacity-60 flex items-center gap-1"><i data-lucide="calendar" class="w-3 h-3"></i> ${l.date}</span>
                                <span class="text-xs opacity-60 flex items-center gap-1"><i data-lucide="clock" class="w-3 h-3"></i> ${l.duration}</span>
                            </div>
                            <h1 class="text-2xl md:text-3xl font-bold font-serif ${titleColor}">${l.content.title}</h1>
                            <p class="opacity-80 text-lg">${l.content.description}</p>
                        </div>

                        <!-- Player Area -->
                        <div class="p-4 rounded-xl mb-8 flex flex-col items-center justify-center gap-4 ${playerBg}">
                            <div class="flex gap-2 bg-slate-200 dark:bg-slate-800 p-1 rounded-lg mb-4">
                                <button onclick="actions.setPlayerMode('embed')" class="flex items-center gap-2 px-3 py-1.5 rounded-md text-sm font-medium transition-all ${state.playerMode === 'embed' ? toggleActive : toggleInactive}">
                                    <i data-lucide="wifi" class="w-4 h-4"></i> সাধারণ প্লেয়ার
                                </button>
                                <button onclick="actions.setPlayerMode('direct')" class="flex items-center gap-2 px-3 py-1.5 rounded-md text-sm font-medium transition-all ${state.playerMode === 'direct' ? toggleActive : toggleInactive}">
                                    <i data-lucide="gauge" class="w-4 h-4"></i> স্পিড কন্ট্রোল
                                </button>
                            </div>

                            <div class="w-full flex flex-col items-center text-center gap-2">
                                ${state.playerMode === 'embed' ? `
                                    <div class="w-full max-w-2xl bg-emerald-900 rounded-lg overflow-hidden shadow-lg relative animate-fade-in">
                                        <iframe src="${getDriveEmbedLink(l.driveLink)}" class="w-full h-[120px] border-0" allow="autoplay" title="Audio Player"></iframe>
                                    </div>
                                ` : `
                                    <div class="w-full max-w-md animate-fade-in">
                                        <div class="p-4 rounded-lg mb-3 text-sm flex items-start gap-2 text-left ${state.darkMode ? 'bg-amber-900/20 text-amber-200' : 'bg-amber-50 text-amber-800'}">
                                            <i data-lucide="alert-circle" class="w-4 h-4 mt-0.5 shrink-0"></i>
                                            <p>এই প্লেয়ারে সমস্যা হলে "সাধারণ প্লেয়ার" ব্যবহার করুন।</p>
                                        </div>
                                        <audio id="audioPlayer" controls class="w-full mb-4" src="${getDriveDirectLink(l.driveLink)}"></audio>
                                        <div class="flex items-center justify-center gap-2">
                                            <span class="text-xs font-bold uppercase tracking-wider opacity-60">Speed:</span>
                                            ${[1.0, 1.25, 1.5, 2.0].map(rate => `
                                                <button onclick="actions.setSpeed(${rate})" class="px-3 py-1 text-xs font-bold rounded-md transition-all ${state.playbackRate === rate ? 'bg-emerald-500 text-white shadow-lg' : 'bg-slate-200 text-slate-600 dark:bg-slate-700 dark:text-slate-300'}">${rate}x</button>
                                            `).join('')}
                                        </div>
                                    </div>
                                `}
                                <div class="flex flex-col items-center gap-2 mt-6 border-t border-dashed border-gray-500/30 w-full max-w-md pt-4 opacity-80">
                                    <a href="${l.driveLink}" target="_blank" class="flex items-center gap-2 bg-emerald-600 hover:bg-emerald-700 text-white px-6 py-2.5 rounded-full font-medium transition-transform active:scale-95 shadow-lg shadow-emerald-500/30">
                                        <i data-lucide="play" class="w-4 h-4" fill="currentColor"></i> ${TEXTS.playOnDrive} / ${TEXTS.download}
                                    </a>
                                </div>
                            </div>
                        </div>

                        <!-- Syllabus -->
                        ${l.content.syllabus ? `
                        <div class="p-5 rounded-xl border-l-4 shadow-sm mb-6 ${state.darkMode ? 'bg-indigo-900/20 border-indigo-500 text-indigo-100' : 'bg-indigo-50 border-indigo-500 text-indigo-900'}">
                            <div class="flex items-start gap-3">
                                <i data-lucide="book-marked" class="w-5 h-5 shrink-0 mt-1 text-indigo-500"></i>
                                <div>
                                    <h3 class="font-bold text-lg mb-2">${TEXTS.syllabus}</h3>
                                    <p class="leading-relaxed opacity-90">${l.content.syllabus}</p>
                                </div>
                            </div>
                        </div>
                        ` : ''}

                        <!-- Content Grid -->
                        <div class="grid md:grid-cols-3 gap-8">
                            <div class="md:col-span-2 space-y-4">
                                <h3 class="text-lg font-bold flex items-center gap-2 pb-2 border-b border-dashed border-gray-500/30 opacity-50">
                                    <i data-lucide="book-open" class="w-4 h-4"></i> ${TEXTS.summary}
                                </h3>
                                <div class="prose max-w-none ${state.darkMode ? 'prose-invert text-slate-300' : 'text-stone-700'}">
                                    ${summaryHTML}
                                </div>
                            </div>
                            <div class="space-y-4">
                                <h3 class="text-lg font-bold flex items-center gap-2 pb-2 border-b border-dashed border-gray-500/30 opacity-50">
                                    <i data-lucide="download" class="w-4 h-4"></i> ${TEXTS.resources}
                                </h3>
                                ${resourcesHTML}
                            </div>
                        </div>

                    </div>
                </div>
            </main>
            `;
        }

        function renderFooter() {
            return `
            <footer class="py-6 text-center text-sm opacity-60 border-t ${state.darkMode ? 'border-slate-800' : 'border-stone-200'}">
                <div class="container mx-auto px-4">
                    <p>${TEXTS.footerText}</p>
                </div>
            </footer>
            `;
        }

        /**
         * ==================================================================================
         * ACTIONS & EVENTS
         * ==================================================================================
         */
        const actions = {
            toggleTheme: () => {
                state.darkMode = !state.darkMode;
                render();
            },
            goHome: () => {
                state.view = 'home';
                state.selectedLecture = null;
                render();
            },
            setFilter: (cat) => {
                state.filter = cat;
                render();
            },
            setSearch: (val) => {
                state.search = val;
                // Only re-render home if we are on home
                if(state.view === 'home') render(); 
                // Restore focus is handled in render()
            },
            selectLecture: (id) => {
                state.selectedLecture = COURSE_DATA.find(l => l.id === id);
                state.view = 'detail';
                state.playerMode = 'embed';
                state.playbackRate = 1.0;
                window.scrollTo(0,0);
                render();
            },
            setPlayerMode: (mode) => {
                state.playerMode = mode;
                render();
            },
            setSpeed: (rate) => {
                state.playbackRate = rate;
                const audio = document.getElementById('audioPlayer');
                if(audio) audio.playbackRate = rate;
                // Re-render to update button styles
                render();
            }
        };

        // Helper to attach global listeners if needed, 
        // though inline onclicks are used here for simplicity in a single file
        function attachListeners() {
            // Nothing complex needed for this version
        }

        // Initialize
        // Check system theme preference
        if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
            state.darkMode = true;
        }
        render();

    </script>
</body>
</html>